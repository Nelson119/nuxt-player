/* ========================== Name:CVPlayer V1.0.5.0 UpDate:2011-01-26 Author:Mars ========================== */ function gotoPage(intPage) { var thisForm = this.document.form1; thisForm.CVPlayer.SpecifyPageToPlay(intPage); } function GetMessage(files , data) { var thisForm = this.document.form1; switch(files) { case "ChangePage": thisForm.CutPage.options[data - 1].selected = true; GoPage(data); showstyle(thisForm.CutPage); setTimeout("clearstyle(thisForm.CutPage)", 1000); break; case "NotifyPlayerStop": if(typeof(showstreamstop)=="function") { showstreamstop(data); } break; case "CamEvent": if(typeof(showEvent)=="function") { showEvent(data); } break; case "Zoomin": if(typeof(SetZoom)=="function") { SetZoom(); } break; case "Zoomout": if(typeof(SetZoomOut)=="function") { SetZoomOut(); } break; case "AlarmServerError": break; case "SendCoordinate": if(typeof(SetCoordinate)=="function") { SetCoordinate(data); } break; case "OnFocus": if(typeof(GetOnFocus)=="function") { GetOnFocus(data); } break; case "OnFocusWithCamid": if(typeof(GetOnFocusWithCamid)=="function") { GetOnFocusWithCamid(data); } break; case "CallAction": //if(typeof(GetPW)=="function") //{ // GetPW(data); //} break; case "zoominbtn": var tmpCVPlayerFrame = CVPlayerFrame; CVPlayerFrame = '1'; SetSize(); CVPlayerFrame = tmpCVPlayerFrame; /* else { LoadVideoFileForPlay(); } */ break; default: break; } /* if(files == "ChangePage") { thisForm.CutPage.options[data-1].selected = true; showstyle(thisForm.CutPage); setTimeout("clearstyle(thisForm.CutPage)" ,2000); } */ } /* function GetPW(data) { var aryUri = data.split("&"); var params1 = aryUri[0].split("="); var cmd = params1[1] + ""; var params2 = aryUri[1].split("="); var ncip = params2[1] + ""; var params3 = aryUri[2].split("="); var camid = params3[1] + ""; if(cmd == "move") PageMethods.RemovePassword(ncip,camid); if(cmd == "restore") PageMethods.RestorePassword(ncip,camid); } */ function SetPlayerNumber(intSplit,intWidth,intHeight) { var thisForm = this.document.form1; thisForm.CVPlayer.SetPlayerNumber(intSplit, intWidth, intHeight); } function StartToPlay() { try { var thisForm = this.document.form1; thisForm.CVPlayer.StartToPlay(); } catch (e) { } } function StartToPlayByIndex(intIndex,strVideo,strTitle) { var thisForm = this.document.form1; thisForm.CVPlayer.StartToPlayByIndex(intIndex,strVideo, strTitle); } function SetPlaylist(strVideo,strTitle) { var thisForm = this.document.form1; thisForm.CVPlayer.SetPlaylist(strVideo, strTitle); } function doStartPlay() { var thisForm = this.document.form1; thisForm.CVPlayer.SingleStartToPlay(); } function AllStartPlay() { var thisForm = this.document.form1; thisForm.CVPlayer.AllStartToPlay(); } function StartToLoopPlay() { var thisForm = this.document.form1; thisForm.CVPlayer.StartToLoopPlay(); } function SetLoopInterval(intSec) { var thisForm = this.document.form1; thisForm.CVPlayer.SetLoopInterval(intSec); } function StopToLoopPlay() { var thisForm = this.document.form1; thisForm.CVPlayer.StopToLoopPlay(); } function SetFullScreen() { setTimeout("var thisForm = this.document.form1;thisForm.CVPlayer.SetFullScreen();", 100); } function SetBacktoOriginalSize() { var thisForm = this.document.form1; thisForm.CVPlayer.SetBacktoOriginalSize(); } function maxWindow() { window.moveTo(0,0); window.open("","","fullscreen,scrollbars"); if (document.all) { top.window.resizeTo(screen.availWidth,screen.availHeight); document.write(screen.availWidth + " " + screen.availHeight); } else if (document.layers||document.getElementById) { if (top.window.outerHeight= 0) { document.write('\n'); } else { document.write('\n'); } } //重置CVPlayer function Reset() { try { var thisForm = this.document.form1; thisForm.CVPlayer.Reset(); } catch(e) { } } //設定語系 function SetCulture(language) { try { var thisForm = this.document.form1; thisForm.CVPlayer.SetCulture(language); } catch (e) {} } function setPlayerPositionByPercent(value) { try { var thisForm = this.document.form1; thisForm.CVPlayer.setPlayerPositionByPercent(value); } catch(e){ } } function setPlayerPositionByTime(hr, min, sec) { try { var thisForm = this.document.form1; thisForm.CVPlayer.setPlayerPositionByTime(hr, min, sec); } catch(e) { } } function getVideoLength() { var vl = ""; var thisForm = this.document.form1; if (thisForm.CVPlayer) { try{ vl = thisForm.CVPlayer.getVideoLength(); } catch(e) { } } return vl; } function IVSControlFromWeb() { var thisForm = this.document.form1; thisForm.CVPlayer.IVSControlFromWeb(); } //ShowFile/Live/Live_SelCam.aspx function detectcvplayer(anAlt, link) { try { var objDownload = new ActiveXObject("Butterfly.UserControl1"); var newVersion = link.substring(link.indexOf("cvplayer-v"), link.indexOf(".exe")).replace("cvplayer-v", ""); var updateMsg = "目前CVPlayer已有更新版本至v" + newVersion + "，建請下載使用。"; var currentVersion = objDownload.ReportCurrentVersion() || ""; currentVersion = currentVersion.split(".").join(""); if (currentVersion != newVersion) { if (confirm(updateMsg)) { window.location.href = link; } } } catch(exception) { if(confirm(anAlt)) { //window.location.href="http://vrs.hinet.net/download/CVPlayer/setup.exe"; if (link == "") link = "http://vrs.hinet.net/download/CVPlayer/v163/cvplayer-v163j.exe"; window.location.href = link; } } } function setPlayerSnapshotNum(number) { var thisForm = this.document.form1; thisForm.CVPlayer.setSnapshotNum(number); } function AllStartToFFW() { var thisForm = this.document.form1; thisForm.CVPlayer.AllStartToFFW(); } function AllStartToRewind() { var thisForm = this.document.form1; thisForm.CVPlayer.AllStartToRewind(); } 